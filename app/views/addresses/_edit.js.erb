var address_element = $.parseHTML('<%=j render partial: "addresses/edit", formats: [:html], locals: {claim: claim, person: person, address: address, options:options}  %>');
<% unless options.has_key? :no_postcode_override %>
  var postcode = $('#address-<%= address.id %> .postcode').val();
  $(address_element).find('.postcode').val(postcode);
<% end %>
$('#address-<%= address.id %>').prepend(address_element);

// allow reflow before css animation starts
setTimeout(function() {
  $('#address-<%= address.id %> .copy-address').remove();
  $('#address-<%= address.id %> .manual-address').remove();
  $('#address-<%= address.id %> #address-<%= address.id %>-inner').addClass('expando');
}, 0);
